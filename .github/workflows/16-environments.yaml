name: 16 - Working with Environment
run-name: 16 - Working with Environment | env - ${{ inputs.target-env }} 

on: 
    workflow_dispatch:
        inputs:
            target-env:
                type: environment
                default: staging

jobs:
     deploy-staging:
         runs-on: ubuntu-latest
         environment: staging
         env:
            my-env-value: ${{ vars.MY_ENV_VALUE || 'default value' }}
         steps:
            - name: Echo vars
              run: |
                 echo "Deploying to staging : ${{ env.my-env-value }}" 
                 
     e2e-tests:
          runs-on: ubuntu-latest
          needs: deploy-staging
          steps:
            - name: E2E tests
              run: echo "Running e2e"               

     deploy-prod:
         runs-on: ubuntu-latest
         needs: e2e-tests
         environment: prod
         env:
            my-env-value: ${{ vars.MY_ENV_VALUE || 'default value' }}
         steps:
            - name: Echo vars
              run: |
                 echo "Deploying to prod : ${{ env.my-env-value }}"              


